---
title: https+httpDNS遇到的那些坑
date: 2016-12-21 11:27:41
tags: https, httpDNS
categories: Android
---
https和httpDNS的优缺点我就不说了，网上一搜一大把，但是总体来说还是优点大于缺点的，否则也不用非那么大功夫折腾这儿玩意儿了。
下边我就主要说一下我们最近引入https+httpDNS遇到的一些坑。

###方案探索:
1. Request执行前替换域名为ip地址
这种方案实现起来很简单，没有任何技术性的问题，只需要发送前做一个处理就行。 这种方案单独使用https或者单独使用httpDNS没有任何问题，但是一旦两者结合起来就产生了问题。主要的问题是SNI的问题。
SNI（Server Name Indication）是为了解决一个服务器使用多个域名和证书的SSL/TLS扩展。 一句话简述它的工作原理就是，在连接到服务器建立SSL连接之前先发送要访问站点的域名（Hostname）， 这样服务器根据这个域名返回一个合适的证书。
由于是通过IP进行访问的，服务如果IP服务器上设置